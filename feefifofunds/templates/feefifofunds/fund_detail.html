{% extends '_base.html' %}

{% block title %}{{ fund.ticker }} - {{ fund.name }}{% endblock %}

{% block content %}
<div class="container">
  <h1>{{ fund.ticker }} - {{ fund.name }}</h1>

  <!-- Basic Info -->
  <div class="fund-info">
    <h2>Basic Information</h2>
    <dl>
      <dt>Provider:</dt>
      <dd>{{ fund.provider.name }}</dd>

      <dt>Fund Type:</dt>
      <dd>{{ fund.get_fund_type_display }}</dd>

      <dt>Asset Class:</dt>
      <dd>{{ fund.get_asset_class_display }}</dd>

      <dt>Geographic Focus:</dt>
      <dd>{{ fund.get_geographic_focus_display }}</dd>

      {% if fund.inception_date %}
      <dt>Inception Date:</dt>
      <dd>{{ fund.inception_date }}</dd>
      {% endif %}

      {% if fund.aum %}
      <dt>Assets Under Management:</dt>
      <dd>${{ fund.aum }} million</dd>
      {% endif %}
    </dl>

    {% if fund.description %}
    <h3>Description</h3>
    <p>{{ fund.description }}</p>
    {% endif %}
  </div>

  <!-- Fee Structure -->
  <div class="fee-structure">
    <h2>Fee Structure</h2>
    <dl>
      <dt>MER (Management Expense Ratio):</dt>
      <dd><strong>{{ fund.mer }}%</strong></dd>

      {% if fund.front_load > 0 %}
      <dt>Front-end Load:</dt>
      <dd>{{ fund.front_load }}%</dd>
      {% endif %}

      {% if fund.back_load > 0 %}
      <dt>Back-end Load (DSC):</dt>
      <dd>{{ fund.back_load }}%</dd>
      {% endif %}

      {% if fund.transaction_fee > 0 %}
      <dt>Transaction Fee:</dt>
      <dd>${{ fund.transaction_fee }}</dd>
      {% endif %}
    </dl>
  </div>

  <!-- Performance Data -->
  <div class="performance">
    <h2>Performance History</h2>
    <table>
      <thead>
        <tr>
          <th>YTD</th>
          <th>1 Year</th>
          <th>3 Year</th>
          <th>5 Year</th>
          <th>10 Year</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>{{ fund.ytd_return|default:"-" }}%</td>
          <td>{{ fund.one_year_return|default:"-" }}%</td>
          <td>{{ fund.three_year_return|default:"-" }}%</td>
          <td>{{ fund.five_year_return|default:"-" }}%</td>
          <td>{{ fund.ten_year_return|default:"-" }}%</td>
        </tr>
      </tbody>
    </table>
    {% if fund.last_data_update %}
    <p><small>Last updated: {{ fund.last_data_update }}</small></p>
    {% endif %}
  </div>

  <!-- Fee Impact Calculator -->
  <div class="fee-impact">
    <h2>Fee Impact Example</h2>
    <p>Impact of {{ fund.mer }}% MER on a ${{ initial_investment|floatformat:0 }} investment over {{ years }} years (assuming 7% annual return):</p>

    <dl>
      <dt>Final Value With Fees:</dt>
      <dd><strong>${{ fee_impact.final_value_with_fees|floatformat:2 }}</strong></dd>

      <dt>Final Value Without Fees (0% MER):</dt>
      <dd>${{ fee_impact.final_value_without_fees|floatformat:2 }}</dd>

      <dt>Total Fees Paid:</dt>
      <dd><span style="color: red;">${{ fee_impact.total_fees_paid|floatformat:2 }}</span></dd>

      <dt>Fee Impact:</dt>
      <dd><span style="color: red;">${{ fee_impact.fee_impact|floatformat:2 }} ({{ fee_impact.fee_impact_percentage }}%)</span></dd>
    </dl>

    <p><em>Note: This is an illustrative example. Actual returns will vary.</em></p>
  </div>

  <!-- Similar Funds -->
  {% if similar_funds %}
  <div class="similar-funds">
    <h2>Similar Funds (Same Asset Class & Region)</h2>
    <table>
      <thead>
        <tr>
          <th>Ticker</th>
          <th>Name</th>
          <th>Type</th>
          <th>MER (%)</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for similar in similar_funds %}
        <tr>
          <td><strong>{{ similar.ticker }}</strong></td>
          <td>{{ similar.name }}</td>
          <td>{{ similar.get_fund_type_display }}</td>
          <td>{{ similar.mer }}</td>
          <td><a href="{% url 'feefifofunds:fund_detail' similar.slug %}">View</a></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %}

  <!-- Navigation -->
  <div class="navigation">
    <a href="{% url 'feefifofunds:fund_list' %}">‚Üê Back to Fund List</a>
    <a href="{% url 'feefifofunds:compare' %}?funds={{ fund.id }}">Compare with Other Funds</a>
  </div>
</div>
{% endblock %}
